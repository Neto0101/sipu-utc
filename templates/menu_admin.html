<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Panel Admin - SIPU UTC</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

<style>
body {
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 0;
    background: #181818;
    color: #fff;
}

/* Contenedor general centrado */
.container {
    width: 90%;
    max-width: 1200px;
    margin: 50px auto;
}

/* Títulos */
h1 {
    color: #00c3ff;
    text-align: center;
    margin-bottom: 30px;
}
h2 {
    text-align: center;
    color: #fff;
}

/* ===== Menú superior estilo pestañas ===== */
.tabs {
    display: flex;
    justify-content: center;
    margin-bottom: 40px;
    border-bottom: 1px solid #444;
}
.tab-button {
    background: none;
    color: #bbb;
    font-size: 16px;
    padding: 10px 25px;
    margin: 0 10px;
    border: none;
    border-bottom: 3px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
}
.tab-button:hover {
    color: #00c3ff;
}
.tab-button.active {
    color: #00c3ff;
    border-bottom: 3px solid #00c3ff;
}

/* ===== Panel general ===== */
.panel {
    display: none;
    background: rgba(255, 255, 255, 0.05);
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
}
.panel.active {
    display: block;
}

/* ===== Formularios ===== */
.add-form {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
}
.add-form input,
.add-form select {
    padding: 8px;
    border-radius: 5px;
    border: none;
    text-align: center;
    background: #222;
    color: #fff;
}

/* Botones */
.btn {
    background: #00bfff;
    color: #fff;
    padding: 7px 15px;
    border-radius: 5px;
    text-decoration: none;
    cursor: pointer;
    border: none;
}
.btn:hover {
    background: #0088cc;
}

/* ===== Tabla ===== */
table {
    width: 90%;
    max-width: 1000px;
    margin: 20px auto;
    border-collapse: collapse;
    font-size: 14px;
    text-align: center;
    background: #222;
    border-radius: 10px;
    overflow: hidden;
}
th, td {
    padding: 10px;
    border-bottom: 1px solid #333;
}
th {
    background: #00bfff;
    color: #fff;
}
tr:last-child td {
    border-bottom: none;
}
tr:hover {
    background: rgba(0, 191, 255, 0.1);
}
table input,
table select {
    width: 100%;
    background: transparent;
    border: none;
    color: #fff;
    text-align: center;
    outline: none;
}

/* ===== Footer ===== */
footer {
    text-align: center;
    margin-top: 40px;
    color: #777;
    font-size: 14px;
}

/* ===== MODAL CERRAR SESIÓN ===== */
.modal-bg {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    justify-content: center;
    align-items: center;
    z-index: 3000;
}

.modal {
    background: #222;
    padding: 30px;
    border-radius: 12px;
    width: 350px;
    text-align: center;
    color: #fff;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
}

.modal h3 {
    margin-bottom: 20px;
    font-size: 18px;
    color: #00c3ff;
}

.modal-buttons {
    display: flex;
    justify-content: space-between;
    margin-top: 25px;
}

.btn-confirm {
    background-color: #d9534f;
    color: white;
    padding: 10px 25px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
}

.btn-cancel {
    background-color: #6c757d;
    color: white;
    padding: 10px 25px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
}

.btn-confirm:hover { background-color: #c9302c; }
.btn-cancel:hover { background-color: #5a6268; }
</style>
</head>

<body>
<div class="container">
<h1>Panel Administrador</h1>

<!-- Menú superior -->
<div class="tabs">
    <button class="tab-button active" onclick="openTab('alumnos')">Alumnos</button>
    <button class="tab-button" onclick="openTab('maestros')">Maestros</button>
    <button class="tab-button" onclick="abrirModal()">Cerrar sesión</button>
</div>

<!-- PANEL ALUMNOS -->
<div id="alumnos" class="panel active">
<h2>Alumnos</h2>

<form class="add-form" action="{{ url_for('agregar_alumno') }}" method="POST">

    <input type="text" name="grado" placeholder="Grado" required>

    <select name="plantel" required>
        <option value="">Selecciona plantel</option>
        {% for p in planteles %}
        <option value="{{ p['nombre_plantel'] }}">{{ p['nombre_plantel'] }}</option>
        {% endfor %}
    </select>

    <select name="carrera" required>
        <option value="">Selecciona carrera</option>
        {% for c in carreras %}
        <option value="{{ c['nombre_carrera'] }}">{{ c['nombre_carrera'] }}</option>
        {% endfor %}
    </select>

    <input type="text" name="turno" placeholder="Turno" required>
    <input type="text" name="grupo" placeholder="Grupo" required>
    <input type="text" name="matricula" placeholder="Matrícula" required>
    <input type="text" name="a_paterno" placeholder="Apellido Paterno" required>
    <input type="text" name="a_materno" placeholder="Apellido Materno" required>
    <input type="text" name="nombre" placeholder="Nombre" required>

    <button type="submit" class="btn">Agregar Alumno</button>
</form>

<table>
    <tr>
        <th>Grado</th>
        <th>Plantel</th>
        <th>Carrera</th>
        <th>Turno</th>
        <th>Grupo</th>
        <th>Matrícula</th>
        <th>A. Paterno</th>
        <th>A. Materno</th>
        <th>Nombre</th>
        <th>Modificar</th>
        <th>Eliminar</th>
    </tr>

    {% for a in alumnos %}
    <tr>
        <form action="{{ url_for('modificar_alumno', matricula=a['matricula']) }}" method="POST">

        <td><input type="text" name="grado" value="{{ a['grado'] }}"></td>

        <td>
            <select name="plantel">
                {% for p in planteles %}
                <option value="{{ p['nombre_plantel'] }}" {% if p['nombre_plantel'] == a['plantel'] %}selected{% endif %}>
                    {{ p['nombre_plantel'] }}
                </option>
                {% endfor %}
            </select>
        </td>

        <td>
            <select name="carrera">
                {% for c in carreras %}
                <option value="{{ c['nombre_carrera'] }}" {% if c['nombre_carrera'] == a['carrera'] %}selected{% endif %}>
                    {{ c['nombre_carrera'] }}
                </option>
                {% endfor %}
            </select>
        </td>

        <td><input type="text" name="turno" value="{{ a['turno'] }}"></td>
        <td><input type="text" name="grupo" value="{{ a['grupo'] }}"></td>

        <td>{{ a['matricula'] }}</td>

        <td><input type="text" name="a_paterno" value="{{ a['a_paterno'] }}"></td>
        <td><input type="text" name="a_materno" value="{{ a['a_materno'] }}"></td>
        <td><input type="text" name="nombre" value="{{ a['nombre'] }}"></td>

        <td><button type="submit" class="btn">Modificar</button></td>
        </form>
        <td>
            <form action="{{ url_for('eliminar_alumno', matricula=a['matricula']) }}" method="POST">
                <button type="submit" class="btn">Eliminar</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
</div>

<!-- PANEL MAESTROS -->
<div id="maestros" class="panel">
<h2>Maestros</h2>

<form class="add-form" action="{{ url_for('agregar_maestro') }}" method="POST">
    <input type="text" name="id" placeholder="ID" required>
    <input type="text" name="a_paterno" placeholder="Apellido Paterno" required>
    <input type="text" name="a_materno" placeholder="Apellido Materno" required>
    <input type="text" name="nombre" placeholder="Nombre" required>

    <select name="carrera" required>
        <option value="">Selecciona carrera</option>
        {% for c in carreras %}
        <option value="{{ c['nombre_carrera'] }}">{{ c['nombre_carrera'] }}</option>
        {% endfor %}
    </select>

    <button type="submit" class="btn">Agregar Maestro</button>
</form>

<table>
    <tr>
        <th>ID</th>
        <th>A. Paterno</th>
        <th>A. Materno</th>
        <th>Nombre</th>
        <th>Carrera</th>
        <th>Modificar</th>
        <th>Eliminar</th>
    </tr>

    {% for m in maestros %}
    <tr>
        <form action="{{ url_for('modificar_maestro', id_=m['id']) }}" method="POST">

        <td>{{ m['id'] }}</td>

        <td><input type="text" name="a_paterno" value="{{ m['a_paterno'] }}"></td>
        <td><input type="text" name="a_materno" value="{{ m['a_materno'] }}"></td>
        <td><input type="text" name="nombre" value="{{ m['nombre'] }}"></td>

        <td>
            <select name="carrera">
                {% for c in carreras %}
                <option value="{{ c['nombre_carrera'] }}" {% if c['nombre_carrera'] == m['carrera'] %}selected{% endif %}>
                    {{ c['nombre_carrera'] }}
                </option>
                {% endfor %}
            </select>
        </td>

        <td><button type="submit" class="btn">Modificar</button></td>
        </form>

        <td>
            <form action="{{ url_for('eliminar_maestro', id_=m['id']) }}" method="POST">
                <button type="submit" class="btn">Eliminar</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
</div>

<footer>
  Universidad Tres Culturas © 2025
</footer>
</div>

<!-- MODAL DE CONFIRMACIÓN -->
<div class="modal-bg" id="modalCerrarSesion">
  <div class="modal">
    <h3>¿Está seguro de cerrar sesión?</h3>

    <div class="modal-buttons">
      <button class="btn-confirm" onclick="window.location.href='{{ url_for('logout') }}'">Sí</button>
      <button class="btn-cancel" onclick="cerrarModal()">Cancelar</button>
    </div>
  </div>
</div>

<script>
function openTab(tabName) {
    var i, panels, buttons;
    panels = document.getElementsByClassName("panel");
    for (i = 0; i < panels.length; i++) {
        panels[i].classList.remove("active");
    }
    buttons = document.getElementsByClassName("tab-button");
    for (i = 0; i < buttons.length; i++) {
        buttons[i].classList.remove("active");
    }
    document.getElementById(tabName).classList.add("active");
    event.currentTarget.classList.add("active");
}

function abrirModal() {
    document.getElementById("modalCerrarSesion").style.display = "flex";
}
function cerrarModal() {
    document.getElementById("modalCerrarSesion").style.display = "none";
}
</script>

</body>
</html>
